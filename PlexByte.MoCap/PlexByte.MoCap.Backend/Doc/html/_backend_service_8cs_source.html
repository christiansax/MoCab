<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>My Project: D:/Users/ChristianB/Documents/_HF Infomatik/GitHub_Repos/MoCap/PlexByte.MoCap/PlexByte.MoCap.Backend/BackendService.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_275089585c7fc1b5fd5d7d42c69cb1da.html">D:</a></li><li class="navelem"><a class="el" href="dir_394ff8aee7398e78ab38baed8ef80807.html">Users</a></li><li class="navelem"><a class="el" href="dir_7c15673b751072b4d6601ecdc15e8b3c.html">ChristianB</a></li><li class="navelem"><a class="el" href="dir_9219dc1646f295b3b4b04cc167443e79.html">Documents</a></li><li class="navelem"><a class="el" href="dir_e5054f14bce38e8dffeead423b51db92.html">_HF Infomatik</a></li><li class="navelem"><a class="el" href="dir_00cb454e9b39517de2661f274703cdb2.html">GitHub_Repos</a></li><li class="navelem"><a class="el" href="dir_6929478e8b7d70a3a7df6e2338770fa3.html">MoCap</a></li><li class="navelem"><a class="el" href="dir_935b7872f27b1c83cc99efd40cffc3b8.html">PlexByte.MoCap</a></li><li class="navelem"><a class="el" href="dir_524591ee57c92dda6d7ee6559eb56ac2.html">PlexByte.MoCap.Backend</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">BackendService.cs</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_backend_service_8cs.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//                      Class InteractionService                              </span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//      Author: Christian B. Sax            Date:   2016/03/2</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//      This class provides backend functionality by reading and writing to the database. The class is not intended </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//      for converting business logic but to return record set to the caller for further business logic process.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//      Also inserting is not intended to convert from business objects into the db. Use Adapter classes, to do this</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Collections.Generic;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Data;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Data.SqlClient;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Net.Sockets;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_plex_byte.html">PlexByte</a>.<a class="code" href="namespace_plex_byte_1_1_mo_cap.html">MoCap</a>.Helpers;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_plex_byte.html">PlexByte</a>.<a class="code" href="namespace_plex_byte_1_1_mo_cap.html">MoCap</a>.Interactions;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="namespace_plex_byte_1_1_mo_cap_1_1_backend.html">   15</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_plex_byte.html">PlexByte</a>.MoCap.Backend</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div><div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="namespace_plex_byte_1_1_mo_cap_1_1_backend.html#acbe18958b9ae9c08f5c2d2c580fbbf2a">   17</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">enum</span> <a class="code" href="namespace_plex_byte_1_1_mo_cap_1_1_backend.html#acbe18958b9ae9c08f5c2d2c580fbbf2a">ObjectType</a></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    {</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <a class="code" href="namespace_plex_byte_1_1_mo_cap_1_1_backend.html#acbe18958b9ae9c08f5c2d2c580fbbf2aa8f9bfe9d1345237cb3b2b205864da075">User</a>,</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <a class="code" href="namespace_plex_byte_1_1_mo_cap_1_1_backend.html#acbe18958b9ae9c08f5c2d2c580fbbf2aa9e727fdd3aec8274f46685441900280d">Project</a></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    }</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    </div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">// TODO: Update documentation</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html">   25</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html">BackendService</a> : IDisposable</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    {</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> <span class="keywordtype">string</span> _DBServer = <span class="stringliteral">&quot;198.38.83.33&quot;</span>;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> <span class="keywordtype">string</span> _Password = <span class="stringliteral">&quot;MoCap&quot;</span>;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">string</span> _DBUser = CryptoHelper.Decrypt(<span class="stringliteral">&quot;BjjfgaK9bvsBcQCzh2cA7D0OQnwJ1lrU/36zDXs5bKfbK/mCnQChL74+/wtOu1+6&quot;</span>, _Password);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">string</span> _DBPWD = CryptoHelper.Decrypt(<span class="stringliteral">&quot;mFntrazoOtZJqDO+T8vCdtnm6aUjkfvf0Lh8kATxrZQkfNE0NiPDC7zXkb2h22MM&quot;</span>, _Password);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">string</span> _connectionString = null;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a6515e3116617dbf054be2f26cd7b2e38">   33</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a6515e3116617dbf054be2f26cd7b2e38">BackendService</a>()</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        {</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            _connectionString = <span class="keywordtype">string</span>.Format(<span class="stringliteral">&quot;Server={0}; Database=csax2277_MoCap;User Id={1};Password={2};&quot;</span>, _DBServer, _DBUser, _DBPWD);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        }</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a7859887daa5e4bb760dedcbcc6fb7bf1">   38</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a7859887daa5e4bb760dedcbcc6fb7bf1">Dispose</a>() { _connectionString = null; }</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a1d64ef21282345f37aa3f42cba3656d2">   45</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a1d64ef21282345f37aa3f42cba3656d2">AuthenticateUser</a>(<span class="keywordtype">string</span> pUserName, <span class="keywordtype">string</span> pPassword)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            DataTable userInfo = <span class="keyword">new</span> DataTable();</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            pPassword = CryptoHelper.Encrypt(pPassword, _Password);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            userInfo = ExecuteQueryString($<span class="stringliteral">&quot;select * from View_User where (Username = &#39;{pUserName}&#39; or EmailAddress = &#39;{pUserName}&#39;) AND [Password] = &#39;{pPassword}&#39;&quot;</span>);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            <span class="keywordflow">if</span> (userInfo.Rows.Count &lt; 1)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception($<span class="stringliteral">&quot;Authentification failed! Username or password is invalid [UserName={pUserName}] [Password={pPassword}]&quot;</span>);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(_connectionString))</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                    <span class="comment">// Create the command and set its properties.</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                    SqlCommand command = <span class="keyword">new</span> SqlCommand();</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                    command.Connection = connection;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                    command.CommandText = <span class="stringliteral">&quot;SPROC_AddUserLog&quot;</span>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                    command.CommandType = CommandType.StoredProcedure;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                    <span class="comment">// Add the input parameter and set its properties.</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                    SqlParameter parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@UserId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                    {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                        Direction = ParameterDirection.Input,</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                        Value = Convert.ToInt64(userInfo.Rows[0][<span class="stringliteral">&quot;Id&quot;</span>])</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                    };</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                    command.Parameters.Add(parameter);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                    parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ResultMsg&quot;</span>, SqlDbType.VarChar)</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                    {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                        Direction = ParameterDirection.Output,</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                        Value = <span class="keywordtype">string</span>.Empty</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                    };</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    command.Parameters.Add(parameter);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                    connection.Open();</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                    SqlDataReader reader = command.ExecuteReader();</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                    <span class="keywordflow">if</span> (reader.HasRows)</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                        <span class="keywordflow">while</span> (reader.Read())</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                        {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                            Console.WriteLine(<span class="stringliteral">&quot;{0}: {1:C}&quot;</span>, reader[0], reader[1]);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                        }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                    }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                    {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                        Console.WriteLine(<span class="stringliteral">&quot;No rows found.&quot;</span>);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                    }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                    reader.Close();</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                    <span class="keywordflow">return</span> userInfo;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ada231807a0c0116efff3a13c8d7fed3b">   96</a></span>&#160;        <span class="keyword">public</span> DateTime <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ada231807a0c0116efff3a13c8d7fed3b">LastUserLogin</a>(<span class="keywordtype">string</span> pUserId)</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keywordflow">return</span> DateTime.Parse(ExecuteQueryString($<span class="stringliteral">&quot;select MAX([LogDateTime] from [View_UserLog] where UserId = &#39;{pUserId}&#39;&quot;</span>).</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                Rows[0][<span class="stringliteral">&quot;LogDateTime&quot;</span>].ToString());</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#abe9eb812c39fcf5b1dd130ad3b0878b9">  102</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#abe9eb812c39fcf5b1dd130ad3b0878b9">GetProjectById</a>(<span class="keywordtype">string</span> pId)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_Project where Id = &#39;{pId}&#39;&quot;</span>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ade6c8104facb7205953d0386b4119298">  107</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ade6c8104facb7205953d0386b4119298">GetTaskById</a>(<span class="keywordtype">string</span> pId)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_Task where Id = &#39;{pId}&#39;&quot;</span>);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a28c34c1d41ab5cc143ccfd5012481dfd">  112</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a28c34c1d41ab5cc143ccfd5012481dfd">GetSurveyById</a>(<span class="keywordtype">string</span> pId)</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_Survey where Id = &#39;{pId}&#39;&quot;</span>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        }</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ae6b7cdf41f348ce844dfa08a876495c8">  117</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ae6b7cdf41f348ce844dfa08a876495c8">GetExpenseById</a>(<span class="keywordtype">string</span> pId)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_Expense where Id = &#39;{pId}&#39;&quot;</span>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a01c6f0ba7587e8629b9ede895313ff76">  122</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a01c6f0ba7587e8629b9ede895313ff76">GetTimesliceById</a>(<span class="keywordtype">string</span> pId)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_Timeslice where Id = &#39;{pId}&#39;&quot;</span>);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#aafab3576b46106ef63b5cc279e2f64bb">  127</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#aafab3576b46106ef63b5cc279e2f64bb">GeSurveyOptionById</a>(<span class="keywordtype">string</span> pId)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_SurveyOption where Id = &#39;{pId}&#39;&quot;</span>);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ae70783055b16533fcfee00f2ba93469d">  138</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ae70783055b16533fcfee00f2ba93469d">GetVoteById</a>(<span class="keywordtype">string</span> pId, <span class="keywordtype">bool</span> pIsSurveyId)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            DataTable resultSet = null;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keywordflow">switch</span> (pIsSurveyId)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                <span class="keywordflow">case</span> <span class="keyword">true</span>:</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                    <span class="keywordflow">return</span> resultSet = ExecuteQueryString($<span class="stringliteral">&quot;select * from View_Vote where SurveyId = &#39;{pId}&#39;&quot;</span>);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="keywordflow">case</span> <span class="keyword">false</span>:</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    <span class="keywordflow">return</span> resultSet = ExecuteQueryString($<span class="stringliteral">&quot;select * from View_Vote where Id = &#39;{pId}&#39;&quot;</span>);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <span class="keywordflow">default</span>:</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a6d666dd173330adbf0b356f0144d398c">  152</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a6d666dd173330adbf0b356f0144d398c">GetUserById</a>(<span class="keywordtype">string</span> pId)</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_User where Id = &#39;{pId}&#39;&quot;</span>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ad65376b62e58ba7139cfdb50f05ed929">  157</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ad65376b62e58ba7139cfdb50f05ed929">GetUserByUserName</a>(<span class="keywordtype">string</span> pUserName)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_User where Username = &#39;{pUserName}&#39;&quot;</span>);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a5e1cf727726998caf3fc700dc363b3bb">  169</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a5e1cf727726998caf3fc700dc363b3bb">GetUserByProjectId</a>(<span class="keywordtype">string</span> pId)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_ProjectUserMapping where ProjectId = &#39;{pId}&#39; AND IsActive = 1&quot;</span>);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a30889d7e1506e065e2f88854fae1b120">  180</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a30889d7e1506e065e2f88854fae1b120">GetTaskByProjectId</a>(<span class="keywordtype">string</span> pId)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_ProjectTaskMapping where ProjectId = &#39;{pId}&#39; AND IsActive = 1&quot;</span>);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a21b1069392da4037e583f9d9fcad9d81">  191</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a21b1069392da4037e583f9d9fcad9d81">GetSurveyByProjectId</a>(<span class="keywordtype">string</span> pId, <a class="code" href="namespace_plex_byte_1_1_mo_cap_1_1_backend.html#acbe18958b9ae9c08f5c2d2c580fbbf2a">ObjectType</a> pType)</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_ProjectSurveyMapping where ProjectId = &#39;{pId}&#39; AND IsActive = 1&quot;</span>);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a0d49092e2ea8d8d1a6cad6fb0155906f">  204</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a0d49092e2ea8d8d1a6cad6fb0155906f">GetExpenseByProjectId</a>(<span class="keywordtype">string</span> pId, <a class="code" href="namespace_plex_byte_1_1_mo_cap_1_1_backend.html#acbe18958b9ae9c08f5c2d2c580fbbf2a">ObjectType</a> pType)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_ProjectExpenseMapping where ProjectId = &#39;{pId}&#39; AND IsActive = 1&quot;</span>);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a0ff59c331b4b94659b875602a54ece65">  216</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a0ff59c331b4b94659b875602a54ece65">GetTimesliceByProjectId</a>(<span class="keywordtype">string</span> pId, <a class="code" href="namespace_plex_byte_1_1_mo_cap_1_1_backend.html#acbe18958b9ae9c08f5c2d2c580fbbf2a">ObjectType</a> pType)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_ProjectTimesliceMapping where ProjectId = &#39;{pId}&#39; AND IsActive = 1&quot;</span>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a35fe823ccc300f00bd72f99313609835">  226</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a35fe823ccc300f00bd72f99313609835">GetSurveyOptions</a>(<span class="keywordtype">string</span> pSurveyId)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_SurveyOptions where SurveyId = {pSurveyId}&quot;</span>);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="comment">/*  SurveyId            Survey                          OptionId            SurveyOption        UserId  Username        Total</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">            20160225225053154   Which option would you go for?  20160225225057154   Choose option one   1       christian.sax   2</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">            20160225225053154   Which option would you go for?  20160225225057154   Choose option one   1       NULL            2</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">            20160225225053154   Which option would you go for?  20160225225057154   Choose option one   NULL    NULL            2</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">            20160225225053154   Which option would you go for?  20160225225057154   NULL                NULL    NULL            2</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">            20160225225053154   Which option would you go for?  NULL                NULL                NULL    NULL            2</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">            20160225225053154   NULL                            NULL                NULL                NULL    NULL            2</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">            20160225225053190   What animal do you like most    20160225225057158   Jump on option three 1      christian.sax   1</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">            20160225225053190   What animal do you like most    20160225225057158   Jump on option three 1      NULL            1</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">            20160225225053190   What animal do you like most    20160225225057158   Jump on option three NULL   NULL            1</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">            20160225225053190   What animal do you like most    20160225225057158   NULL                NULL    NULL            1</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">            20160225225053190   What animal do you like most    NULL                NULL                NULL    NULL            1</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">            20160225225053190   NULL                            NULL                NULL                NULL    NULL            1</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">            NULL                NULL                            NULL                NULL                NULL    NULL            3</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a709aa17c80b19ca328d99eb468b9054b">  252</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a709aa17c80b19ca328d99eb468b9054b">GetVoteCount</a>(<span class="keywordtype">string</span> pSurveyId)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_VoteCount where SurveyId = {pSurveyId}&quot;</span>);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a922269b8f99a4c0c92d4d7df51f7024b">  262</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a922269b8f99a4c0c92d4d7df51f7024b">GetProjectsByUser</a>(<span class="keywordtype">string</span> pUserId)</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from View_Project where Id in (select ProjectId from View_ProjectUserMapping where &quot;</span> +</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                      $<span class="stringliteral">&quot;UserId = &#39;{pUserId}&#39;) OR ([OwnerId] = &#39;{pUserId}&#39; OR [CreatorId] = &#39;{pUserId}&#39;)  AND IsActive = 1&quot;</span> +</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                      $<span class="stringliteral">&quot; order by [Name]&quot;</span>);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ab33310787b59934d0282f6f2d11d239c">  269</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ab33310787b59934d0282f6f2d11d239c">GetAllReferencedUsers</a>(<span class="keywordtype">string</span> pUserId)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            DataTable users = <span class="keyword">new</span> DataTable();</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="comment">// Get all projects for this user</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keywordflow">foreach</span> (DataRow row <span class="keywordflow">in</span> GetProjectsByUser(pUserId).Rows)</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <span class="comment">// Loop through all projects and check the usermapping</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                <span class="keywordflow">foreach</span> (DataRow row2 <span class="keywordflow">in</span> GetUserByProjectId(row[<span class="stringliteral">&quot;Id&quot;</span>].ToString()).Rows)</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    <span class="keywordflow">foreach</span> (DataRow userRow <span class="keywordflow">in</span> GetUserById(row2[<span class="stringliteral">&quot;Id&quot;</span>].ToString()).Rows)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                        <span class="keywordflow">if</span> (!users.Rows.Contains(userRow))</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                            users.Rows.Add(userRow);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                    }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keywordflow">return</span> users;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a2f3b313c5d86880ca913320041b47d6a">  294</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a2f3b313c5d86880ca913320041b47d6a">GetExpenseByProjectId</a>(<span class="keywordtype">string</span> pId)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from [View_Expenses] where [ProjectId] = &#39;{pId}&#39; order by ProjectId&quot;</span>);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#aecab0686e55208dd16015580bc4082fc">  306</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#aecab0686e55208dd16015580bc4082fc">GetTimeSliceByProjectId</a>(<span class="keywordtype">string</span> pId)</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from [View_Timeslice] where [ProjectId] = &#39;{pId}&#39; order by ProjectId&quot;</span>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a84dac75b5ae2e9d807f9f617c652cfa0">  317</a></span>&#160;        <span class="keyword">public</span> DataTable <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a84dac75b5ae2e9d807f9f617c652cfa0">GetAccountByProjectId</a>(<span class="keywordtype">string</span> pId)</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="keywordflow">return</span> ExecuteQueryString($<span class="stringliteral">&quot;select * from [View_ProjectAccountSummary] where [ProjectId] = &#39;{pId}&#39; order by ProjectId&quot;</span>);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        }</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keyword">private</span> DataTable ExecuteQueryString(<span class="keywordtype">string</span> pSQLQuery)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            DataTable tbl = null;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(_connectionString))</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <span class="keyword">using</span> (SqlCommand command = <span class="keyword">new</span> SqlCommand(pSQLQuery))</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                    command.Connection = connection;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                    command.CommandType = CommandType.Text;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                    connection.Open();</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    SqlDataReader reader = command.ExecuteReader();</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                    tbl = <span class="keyword">new</span> DataTable();</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                    tbl.Load(reader);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                    connection.Close();</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="keywordflow">return</span> tbl;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">int</span> ExecuteInsertString(<span class="keywordtype">string</span> pInsertQuery, List&lt;string&gt; pStringValueList)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keywordtype">int</span> affectedRecords = 0;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(_connectionString))</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                <span class="keyword">using</span> (SqlCommand command = <span class="keyword">new</span> SqlCommand(pInsertQuery))</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                    command.Connection = connection;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                    command.CommandType = CommandType.Text;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                    <span class="comment">// Find values section</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                    <span class="keywordtype">string</span> valuesSection = <span class="keywordtype">string</span>.Empty;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                    <span class="keywordflow">if</span> (pInsertQuery.ToLower().IndexOf(<span class="stringliteral">&quot;values&quot;</span>) &gt; 0)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                    {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                        <span class="comment">// We found values, lets extract the string</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                        valuesSection = pInsertQuery.Substring(pInsertQuery.ToLower().IndexOf(<span class="stringliteral">&quot;values&quot;</span>));</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                        <span class="comment">// Format the string for parsing</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                        valuesSection = valuesSection.ToLower().Replace(<span class="stringliteral">&quot;values&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                        valuesSection = valuesSection.ToLower().Replace(<span class="stringliteral">&quot;(&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                        valuesSection = valuesSection.ToLower().Replace(<span class="stringliteral">&quot;)&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                        <span class="comment">// What&#39;s left are the variables... lets split into list</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                        <span class="keywordtype">string</span>[] valueVarList = valuesSection.Split(<span class="charliteral">&#39;,&#39;</span>);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                        valuesSection = null;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; valueVarList.Length; i++)</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                        {</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                            <span class="comment">// Set the parameters according to parameter list...</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                            command.Parameters.AddWithValue(valueVarList[i], pStringValueList[i]);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                        }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                        valueVarList = null;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                    connection.Open();</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                    affectedRecords = command.ExecuteNonQuery();</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                    connection.Close();</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="keywordflow">return</span> affectedRecords;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a3116d762269dad9511ad9be65b8bbc7a">  399</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a3116d762269dad9511ad9be65b8bbc7a">InsertUser</a>(<span class="keywordtype">string</span> pUserId,</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keywordtype">string</span> pFirstName,</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="keywordtype">string</span> pLastName,</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="keywordtype">string</span> pMiddleName,</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="keywordtype">string</span> pEmail,</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            DateTime pBirthdate,</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordtype">string</span> pUserName,</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="keywordtype">string</span> pPassword)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="keywordtype">string</span> execString = <span class="keywordtype">string</span>.Empty;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(_connectionString))</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                <span class="comment">// Create the command and set its properties.</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                SqlCommand command = <span class="keyword">new</span> SqlCommand();</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                command.Connection = connection;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                command.CommandText = <span class="stringliteral">&quot;Sproc_UserAddUpdate&quot;</span>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                command.CommandType = CommandType.StoredProcedure;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                <span class="comment">// Add the input parameter and set its properties.</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                SqlParameter parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@UserId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                    Value = Convert.ToInt64(pUserId)</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                };</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@FirstName&quot;</span>, SqlDbType.NVarChar)</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                {</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                    Value = pFirstName</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                };</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@LastName&quot;</span>, SqlDbType.NVarChar)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                    Value = pLastName</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                };</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@MiddleName&quot;</span>, SqlDbType.NVarChar)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                    Value = pMiddleName</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                };</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@EmailAddress&quot;</span>, SqlDbType.NVarChar)</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                    Value = pEmail</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                };</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@BirthDate&quot;</span>, SqlDbType.DateTime)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                    Value = pBirthdate</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                };</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@UserName&quot;</span>, SqlDbType.NVarChar)</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    Value = pUserName</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                };</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@Password&quot;</span>, SqlDbType.NVarChar)</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                    Value = pPassword</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                };</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ResultMsg&quot;</span>, SqlDbType.VarChar)</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                    Direction = ParameterDirection.Output,</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                    Value = <span class="keywordtype">string</span>.Empty</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                };</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                <span class="comment">// Open the connection and execute the reader.</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                connection.Open();</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                SqlDataReader reader = command.ExecuteReader();</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                <span class="keywordflow">if</span> (reader.HasRows)</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                {</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                    <span class="keywordflow">while</span> (reader.Read())</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                    {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                        Console.WriteLine(<span class="stringliteral">&quot;{0}: {1:C}&quot;</span>, reader[0], reader[1]);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                    }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                {</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    Console.WriteLine(<span class="stringliteral">&quot;No rows found.&quot;</span>);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                }</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                reader.Close();</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            }</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        }</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#af96d38adf2f202848701f9ca94148265">  500</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#af96d38adf2f202848701f9ca94148265">InsertProject</a>(<span class="keywordtype">string</span> pProjectId,</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="keywordtype">string</span> pTitle,</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordtype">string</span> pDescription,</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            DateTime pStartDate,</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            DateTime pEndDate,</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <span class="keywordtype">string</span> pOwner,</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            <span class="keywordtype">bool</span> pEnableBalance,</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <span class="keywordtype">bool</span> pEnableSurvey,</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <span class="keywordtype">bool</span> pIsActive,</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keywordtype">string</span> pCreator,</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            Enum pStateId)</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(_connectionString))</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                <span class="comment">// Create the command and set its properties.</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                SqlCommand command = <span class="keyword">new</span> SqlCommand();</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                command.Connection = connection;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                command.CommandText = <span class="stringliteral">&quot;Sproc_ProjectAddUpdate&quot;</span>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                command.CommandType = CommandType.StoredProcedure;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                <span class="comment">// Add the input parameter and set its properties.</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                SqlParameter parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ProjectId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                    Value = Convert.ToInt64(pProjectId)</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                };</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@Name&quot;</span>, SqlDbType.NVarChar)</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                {</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                    Value = pTitle</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                };</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@Description&quot;</span>, SqlDbType.NVarChar)</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                {</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                    Value = pDescription</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                };</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@EnableBalance&quot;</span>, SqlDbType.Bit)</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                    Value = pEnableBalance</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                };</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@EnableSurvey&quot;</span>, SqlDbType.Bit)</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    Value = pEnableSurvey</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                };</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@StartDateTime&quot;</span>, SqlDbType.DateTime)</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                {</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    Value = pStartDate</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                };</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@EndDateTime&quot;</span>, SqlDbType.DateTime)</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                {</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                    Value = pEndDate</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                };</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@IsActive&quot;</span>, SqlDbType.Bit)</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                    Value = pIsActive</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                };</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@CreatorId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                    Value = Convert.ToInt64(pCreator)</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                };</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@OwnerId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                    Value = Convert.ToInt64(pOwner)</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                };</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@StateId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                    Value = pStateId</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                };</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ResultMsg&quot;</span>, SqlDbType.VarChar)</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                {</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                    Direction = ParameterDirection.Output,</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                    Value = <span class="keywordtype">string</span>.Empty</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                };</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                <span class="comment">// Open the connection and execute the reader.</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                connection.Open();</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                SqlDataReader reader = command.ExecuteReader();</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                <span class="keywordflow">if</span> (reader.HasRows)</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                    <span class="keywordflow">while</span> (reader.Read())</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                    {</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                        Console.WriteLine(<span class="stringliteral">&quot;{0}: {1:C}&quot;</span>, reader[0], reader[1]);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                    }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                {</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                    Console.WriteLine(<span class="stringliteral">&quot;No rows found.&quot;</span>);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                reader.Close();</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            }</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#afe6896f1ee35541cf824d5e44e58b013">  624</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#afe6896f1ee35541cf824d5e44e58b013">InsertTask</a>(<span class="keywordtype">string</span> TaskId,</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            <span class="keywordtype">string</span> InteractionId,</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            DateTime DueDateTime,</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            decimal Budget,</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <span class="keywordtype">int</span> Duration,</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <span class="keywordtype">int</span> Priority,</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <span class="keywordtype">int</span> Progress,</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="keywordtype">int</span> DurationUsed,</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            decimal BudgetUsed,</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            DateTime StartDateTime,</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            DateTime EndDateTime,</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="keywordtype">bool</span> IsActive,</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="keywordtype">string</span> Text,</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <span class="keywordtype">string</span> CreatorId,</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <span class="keywordtype">string</span> OwnerId,</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <span class="keywordtype">string</span> StateId,</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="keywordtype">string</span> ProjectId)</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordtype">string</span> execString = <span class="keywordtype">string</span>.Empty;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(_connectionString))</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                <span class="comment">// Create the command and set its properties.</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                SqlCommand command = <span class="keyword">new</span> SqlCommand();</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                command.Connection = connection;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                command.CommandText = <span class="stringliteral">&quot;Sproc_TaskAddUpdate&quot;</span>;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                command.CommandType = CommandType.StoredProcedure;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                <span class="comment">// Add the input parameter and set its properties.</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                SqlParameter parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@TaskId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                {</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    Value = Convert.ToInt64(TaskId)</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                };</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@InteractionId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                {</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                    Value = Convert.ToInt64(InteractionId)</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                };</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@DueDateTime&quot;</span>, SqlDbType.Date)</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                {</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                    Value = DueDateTime</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                };</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@Budget&quot;</span>, SqlDbType.Decimal)</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                {</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    Value = Budget</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                };</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@Duration&quot;</span>, SqlDbType.Int)</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                {</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    Value = Duration</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                };</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@Priority&quot;</span>, SqlDbType.Int)</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                    Value = Priority</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                };</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@Progress&quot;</span>, SqlDbType.Int)</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                    Value = Progress</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                };</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@DurationUsed&quot;</span>, SqlDbType.Int)</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                    Value = DurationUsed</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                };</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@BudgetUsed&quot;</span>, SqlDbType.Decimal)</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                    Value = BudgetUsed</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                };</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@StartDateTime&quot;</span>, SqlDbType.Date)</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                {</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                    Value = StartDateTime</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                };</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@EndDateTime&quot;</span>, SqlDbType.Date)</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                    Value = EndDateTime</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                };</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@IsActive&quot;</span>, SqlDbType.Bit)</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                    Value = IsActive</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                };</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@Text&quot;</span>, SqlDbType.NVarChar)</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                    Value = Text</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                };</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@CreatorId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                    Value = CreatorId</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                };</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@OwnerId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                {</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                    Value = OwnerId</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                };</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@StateId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                {</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                    Value = StateId</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                };</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ProjectId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                {</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                    Value = ProjectId</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                };</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ResultMsg&quot;</span>, SqlDbType.VarChar)</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                {</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                    Direction = ParameterDirection.Output,</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                    Value = <span class="keywordtype">string</span>.Empty</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                };</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <span class="comment">// Open the connection and execute the reader.</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                connection.Open();</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                SqlDataReader reader = command.ExecuteReader();</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                <span class="keywordflow">if</span> (reader.HasRows)</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                    <span class="keywordflow">while</span> (reader.Read())</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                    {</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                        Console.WriteLine(<span class="stringliteral">&quot;{0}: {1:C}&quot;</span>, reader[0], reader[1]);</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                }</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                {</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                    Console.WriteLine(<span class="stringliteral">&quot;No rows found.&quot;</span>);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                }</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                reader.Close();</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            }</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        }</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a0d1bc95f01b316823e1a45471f91ba85">  797</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a0d1bc95f01b316823e1a45471f91ba85">InsertVote</a>(<span class="keywordtype">string</span> pSurveyId,</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            <span class="keywordtype">string</span> pOptionId,</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            <span class="keywordtype">string</span> pUserId,</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            DateTime pCreated)</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        {</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(_connectionString))</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                <span class="comment">// Create the command and set its properties.</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                SqlCommand command = <span class="keyword">new</span> SqlCommand();</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                command.Connection = connection;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                command.CommandText = <span class="stringliteral">&quot;Sproc_VoteAdd&quot;</span>;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                command.CommandType = CommandType.StoredProcedure;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                <span class="comment">// Add the input parameter and set its properties.</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                SqlParameter parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@SurveyId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                {</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                    Value = Convert.ToInt64(pSurveyId)</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                };</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@UserId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                {</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                    Value = Convert.ToInt64(pUserId)</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                };</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@SurveyOptionId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                {</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                    Value = pOptionId</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                };</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ResultMsg&quot;</span>, SqlDbType.VarChar)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                {</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                    Direction = ParameterDirection.Output,</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                    Value = <span class="keywordtype">string</span>.Empty</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                };</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                <span class="comment">// Open the connection and execute the reader.</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                connection.Open();</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                SqlDataReader reader = command.ExecuteReader();</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                <span class="keywordflow">if</span> (reader.HasRows)</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                {</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                    <span class="keywordflow">while</span> (reader.Read())</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                    {</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                        Console.WriteLine(<span class="stringliteral">&quot;{0}: {1:C}&quot;</span>, reader[0], reader[1]);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                    }</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                }</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                {</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                    Console.WriteLine(<span class="stringliteral">&quot;No rows found.&quot;</span>);</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                }</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            }</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        }</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a81a6b7116d17a1d9dce39e5c8883cd0f">  857</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a81a6b7116d17a1d9dce39e5c8883cd0f">InsertSurvey</a>(<span class="keywordtype">string</span> pId,</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            <span class="keywordtype">string</span> pInteractionId,</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            <span class="keywordtype">int</span> pVotesPerUser,</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            DateTime pDueDateTime,</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            DateTime pStartDateTime,</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            DateTime pEndDateTime,</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            <span class="keywordtype">string</span> pCreatorId,</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            <span class="keywordtype">string</span> pOwnerId,</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            <span class="keywordtype">bool</span> pIsActive,</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            InteractionState pState,</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            <span class="keywordtype">string</span> pProjectId,</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <span class="keywordtype">string</span> pText,</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            <span class="keywordtype">string</span> pTitle)</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        {</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(_connectionString))</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                <span class="comment">// Create the command and set its properties.</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                SqlCommand command = <span class="keyword">new</span> SqlCommand();</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                command.Connection = connection;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                command.CommandText = <span class="stringliteral">&quot;Sproc_SurveyAddUpdate&quot;</span>;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                command.CommandType = CommandType.StoredProcedure;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                <span class="comment">// Add the input parameter and set its properties.</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                SqlParameter parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@SurveyId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                    Value = Convert.ToInt64(pId)</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                };</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@InteractionId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                {</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                    Value = Convert.ToInt64(pInteractionId)</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                };</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@Title&quot;</span>, SqlDbType.NVarChar)</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                {</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                    Value = pTitle</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                };</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@MaxVotePerUser&quot;</span>, SqlDbType.Int)</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                {</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                    Value = pVotesPerUser</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                };</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@DueDateTime&quot;</span>, SqlDbType.DateTime)</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                {</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                    Value = pDueDateTime</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                };</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@TaskId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                {</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                    Value = DBNull.Value</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                };</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@StartDateTime&quot;</span>, SqlDbType.DateTime)</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                    Value = pStartDateTime</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                };</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@EndDateTime&quot;</span>, SqlDbType.DateTime)</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                {</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    Value = pEndDateTime</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                };</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@IsActive&quot;</span>, SqlDbType.Bit)</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                {</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                    Value = pIsActive</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                };</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@Text&quot;</span>, SqlDbType.NVarChar)</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                {</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                    Value = pText</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                };</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@CreatorId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                {</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                    Value = Convert.ToInt64(pCreatorId)</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                };</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@OwnerId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                {</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                    Value = Convert.ToInt64(pOwnerId)</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                };</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@StateId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                {</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                    Value = pState</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                };</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ProjectId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                {</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                    Value = Convert.ToInt64(pProjectId)</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                };</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ResultMsg&quot;</span>, SqlDbType.VarChar)</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                    Direction = ParameterDirection.Output,</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                    Value = <span class="keywordtype">string</span>.Empty</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                };</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                <span class="comment">// Open the connection and execute the reader.</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                connection.Open();</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                SqlDataReader reader = command.ExecuteReader();</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                <span class="keywordflow">if</span> (reader.HasRows)</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                {</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                    <span class="keywordflow">while</span> (reader.Read())</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                    {</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                        Console.WriteLine(<span class="stringliteral">&quot;{0}: {1:C}&quot;</span>, reader[0], reader[1]);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                    }</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                }</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                {</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                    Console.WriteLine(<span class="stringliteral">&quot;No rows found.&quot;</span>);</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                }</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            }</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        }</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a57d4da2ed2044f2f5bddc24ca92ee003"> 1003</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a57d4da2ed2044f2f5bddc24ca92ee003">InsertSurveyOption</a>(<span class="keywordtype">string</span> pId,</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            <span class="keywordtype">string</span> pText,</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            <span class="keywordtype">string</span> pSurveyId)</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        {</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(_connectionString))</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            {</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                <span class="comment">// Create the command and set its properties.</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                SqlCommand command = <span class="keyword">new</span> SqlCommand();</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                command.Connection = connection;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                command.CommandText = <span class="stringliteral">&quot;Sproc_SurveyAddOption&quot;</span>;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                command.CommandType = CommandType.StoredProcedure;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                <span class="comment">// Add the input parameter and set its properties.</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                SqlParameter parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@SurveyOptionId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                {</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                    Value = Convert.ToInt64(pId)</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                };</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@SurveyId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                {</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                    Value = Convert.ToInt64(pSurveyId)</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                };</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@Text&quot;</span>, SqlDbType.NVarChar)</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                {</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                    Value = pText</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                };</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ResultMsg&quot;</span>, SqlDbType.VarChar)</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                {</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                    Direction = ParameterDirection.Output,</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                    Value = <span class="keywordtype">string</span>.Empty</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                };</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                <span class="comment">// Open the connection and execute the reader.</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                connection.Open();</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                SqlDataReader reader = command.ExecuteReader();</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                <span class="keywordflow">if</span> (reader.HasRows)</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                {</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                    <span class="keywordflow">while</span> (reader.Read())</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                    {</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                        Console.WriteLine(<span class="stringliteral">&quot;{0}: {1:C}&quot;</span>, reader[0], reader[1]);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                    }</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                }</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                {</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                    Console.WriteLine(<span class="stringliteral">&quot;No rows found.&quot;</span>);</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                }</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            }</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        }</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div><div class="line"><a name="l01062"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a69c06da763b493aceaeab04a43c41dab"> 1062</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a69c06da763b493aceaeab04a43c41dab">InsertTimeslice</a>(<span class="keywordtype">string</span> pId,</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="keywordtype">int</span> pDuration,</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            <span class="keywordtype">string</span> pTargetId,</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            <span class="keywordtype">string</span> pDescription,</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            <span class="keywordtype">string</span> pTargetType,</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            DateTime pCreatedDateTime)</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        {</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(_connectionString))</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            {</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                <span class="comment">// Create the command and set its properties.</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                SqlCommand command = <span class="keyword">new</span> SqlCommand();</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                command.Connection = connection;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                command.CommandText = <span class="stringliteral">&quot;Sproc_TimesliceAddUpdate&quot;</span>;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                command.CommandType = CommandType.StoredProcedure;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                <span class="comment">// Add the input parameter and set its properties.</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                SqlParameter parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@Id&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                {</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                    Value = Convert.ToInt64(pId)</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                };</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@Duration&quot;</span>, SqlDbType.Int)</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                {</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                    Value = Convert.ToInt32(pDuration)</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                };</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@Description&quot;</span>, SqlDbType.NVarChar)</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                {</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                    Value = pDescription</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                };</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ResultMsg&quot;</span>, SqlDbType.VarChar)</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                {</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                    Direction = ParameterDirection.Output,</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                    Value = <span class="keywordtype">string</span>.Empty</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                };</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                <span class="comment">// Open the connection and execute the reader.</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                connection.Open();</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                SqlDataReader reader = command.ExecuteReader();</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                <span class="keywordflow">if</span> (reader.HasRows)</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                {</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                    <span class="keywordflow">while</span> (reader.Read())</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                    {</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                        Console.WriteLine(<span class="stringliteral">&quot;{0}: {1:C}&quot;</span>, reader[0], reader[1]);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                    }</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                }</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                {</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                    Console.WriteLine(<span class="stringliteral">&quot;No rows found.&quot;</span>);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                }</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                <span class="comment">// Insert mapping record</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                command = <span class="keyword">new</span> SqlCommand();</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                command.Connection = connection;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                command.CommandText = <span class="stringliteral">&quot;Sproc_AccountAddMapping&quot;</span>;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                command.CommandType = CommandType.StoredProcedure;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                <span class="comment">// Add the input parameter and set its properties.</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ProjectId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                {</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                };</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                <span class="keywordflow">if</span> (pTargetType.ToLower() == <span class="stringliteral">&quot;project&quot;</span>)</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                    parameter.Value = Convert.ToInt64(pTargetId);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                    parameter.Value = DBNull.Value;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ObjectId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                {</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                    Value = Convert.ToInt64(pId)</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                };</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ObjectType&quot;</span>, SqlDbType.Int)</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                {</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                    Value = 2</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                };</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@TaskId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                {</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                };</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                <span class="keywordflow">if</span> (pTargetType.ToLower() == <span class="stringliteral">&quot;task&quot;</span>)</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                    parameter.Value = Convert.ToInt64(pTargetId);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                    parameter.Value = DBNull.Value;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ResultMsg&quot;</span>, SqlDbType.VarChar)</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                {</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                    Direction = ParameterDirection.Output,</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                    Value = <span class="keywordtype">string</span>.Empty</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                };</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                <span class="comment">// Open the connection and execute the reader.</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                connection.Open();</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                reader = command.ExecuteReader();</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                <span class="keywordflow">if</span> (reader.HasRows)</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                {</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                    <span class="keywordflow">while</span> (reader.Read())</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                    {</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                        Console.WriteLine(<span class="stringliteral">&quot;{0}: {1:C}&quot;</span>, reader[0], reader[1]);</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                    }</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                }</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                {</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                    Console.WriteLine(<span class="stringliteral">&quot;No rows found.&quot;</span>);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                }</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                reader.Close();</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;            }</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        }</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div><div class="line"><a name="l01195"></a><span class="lineno"><a class="line" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#acd4446e6836f11aa2df58262530a92a5"> 1195</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#acd4446e6836f11aa2df58262530a92a5">InsertProjectMapping</a>(<span class="keywordtype">string</span> ProjectId,</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            <span class="keywordtype">string</span> ObjectId,</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="namespace_plex_byte_1_1_mo_cap_1_1_backend.html#acbe18958b9ae9c08f5c2d2c580fbbf2a">ObjectType</a>)</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        {</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(_connectionString))</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;            {</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                <span class="comment">// Create the command and set its properties.</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                SqlCommand command = <span class="keyword">new</span> SqlCommand();</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                command.Connection = connection;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                command.CommandText = <span class="stringliteral">&quot;Sproce_ProjectAddMapping&quot;</span>;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                command.CommandType = CommandType.StoredProcedure;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                <span class="comment">// Add the input parameter and set its properties.</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                SqlParameter parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ProjectId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                {</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                    Value = Convert.ToInt64(ProjectId)</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                };</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ObjectId&quot;</span>, SqlDbType.BigInt)</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                {</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                    Value = Convert.ToInt64(ObjectId)</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                };</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ObjectType&quot;</span>, SqlDbType.Int)</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                {</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                    Direction = ParameterDirection.Input,</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                    Value = ObjectType</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                };</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                parameter = <span class="keyword">new</span> SqlParameter(<span class="stringliteral">&quot;@ResultMsg&quot;</span>, SqlDbType.VarChar)</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                {</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                    Direction = ParameterDirection.Output,</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                    Value = <span class="keywordtype">string</span>.Empty</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                };</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                command.Parameters.Add(parameter);</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                <span class="comment">// Open the connection and execute the reader.</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                connection.Open();</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                SqlDataReader reader = command.ExecuteReader();</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                <span class="keywordflow">if</span> (reader.HasRows)</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                {</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                    <span class="keywordflow">while</span> (reader.Read())</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                    {</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                        Console.WriteLine(<span class="stringliteral">&quot;{0}: {1:C}&quot;</span>, reader[0], reader[1]);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                    }</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                }</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                {</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                    Console.WriteLine(<span class="stringliteral">&quot;No rows found.&quot;</span>);</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                }</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            }</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        }</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    }</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;}</div><div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_afe6896f1ee35541cf824d5e44e58b013"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#afe6896f1ee35541cf824d5e44e58b013">PlexByte.MoCap.Backend.BackendService.InsertTask</a></div><div class="ttdeci">void InsertTask(string TaskId, string InteractionId, DateTime DueDateTime, decimal Budget, int Duration, int Priority, int Progress, int DurationUsed, decimal BudgetUsed, DateTime StartDateTime, DateTime EndDateTime, bool IsActive, string Text, string CreatorId, string OwnerId, string StateId, string ProjectId)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00624">BackendService.cs:624</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a84dac75b5ae2e9d807f9f617c652cfa0"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a84dac75b5ae2e9d807f9f617c652cfa0">PlexByte.MoCap.Backend.BackendService.GetAccountByProjectId</a></div><div class="ttdeci">DataTable GetAccountByProjectId(string pId)</div><div class="ttdoc">This method returns all users with TotalTime and TotalValue by projectId </div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00317">BackendService.cs:317</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a35fe823ccc300f00bd72f99313609835"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a35fe823ccc300f00bd72f99313609835">PlexByte.MoCap.Backend.BackendService.GetSurveyOptions</a></div><div class="ttdeci">DataTable GetSurveyOptions(string pSurveyId)</div><div class="ttdoc">This method gets all survey options that are available for the survey specified. It uses the SQL view...</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00226">BackendService.cs:226</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a6515e3116617dbf054be2f26cd7b2e38"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a6515e3116617dbf054be2f26cd7b2e38">PlexByte.MoCap.Backend.BackendService.BackendService</a></div><div class="ttdeci">BackendService()</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00033">BackendService.cs:33</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_abe9eb812c39fcf5b1dd130ad3b0878b9"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#abe9eb812c39fcf5b1dd130ad3b0878b9">PlexByte.MoCap.Backend.BackendService.GetProjectById</a></div><div class="ttdeci">DataTable GetProjectById(string pId)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00102">BackendService.cs:102</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_ae70783055b16533fcfee00f2ba93469d"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ae70783055b16533fcfee00f2ba93469d">PlexByte.MoCap.Backend.BackendService.GetVoteById</a></div><div class="ttdeci">DataTable GetVoteById(string pId, bool pIsSurveyId)</div><div class="ttdoc">This method returns either a single vote by its Id or a set of votes connected to a survey ...</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00138">BackendService.cs:138</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_ada231807a0c0116efff3a13c8d7fed3b"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ada231807a0c0116efff3a13c8d7fed3b">PlexByte.MoCap.Backend.BackendService.LastUserLogin</a></div><div class="ttdeci">DateTime LastUserLogin(string pUserId)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00096">BackendService.cs:96</a></div></div>
<div class="ttc" id="namespace_system_html"><div class="ttname"><a href="namespace_system.html">System</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_ab33310787b59934d0282f6f2d11d239c"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ab33310787b59934d0282f6f2d11d239c">PlexByte.MoCap.Backend.BackendService.GetAllReferencedUsers</a></div><div class="ttdeci">DataTable GetAllReferencedUsers(string pUserId)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00269">BackendService.cs:269</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html">PlexByte.MoCap.Backend.BackendService</a></div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00025">BackendService.cs:25</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_af96d38adf2f202848701f9ca94148265"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#af96d38adf2f202848701f9ca94148265">PlexByte.MoCap.Backend.BackendService.InsertProject</a></div><div class="ttdeci">void InsertProject(string pProjectId, string pTitle, string pDescription, DateTime pStartDate, DateTime pEndDate, string pOwner, bool pEnableBalance, bool pEnableSurvey, bool pIsActive, string pCreator, Enum pStateId)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00500">BackendService.cs:500</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a0ff59c331b4b94659b875602a54ece65"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a0ff59c331b4b94659b875602a54ece65">PlexByte.MoCap.Backend.BackendService.GetTimesliceByProjectId</a></div><div class="ttdeci">DataTable GetTimesliceByProjectId(string pId, ObjectType pType)</div><div class="ttdoc">This method gets all Timeslices of a project </div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00216">BackendService.cs:216</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_ade6c8104facb7205953d0386b4119298"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ade6c8104facb7205953d0386b4119298">PlexByte.MoCap.Backend.BackendService.GetTaskById</a></div><div class="ttdeci">DataTable GetTaskById(string pId)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00107">BackendService.cs:107</a></div></div>
<div class="ttc" id="namespace_plex_byte_1_1_mo_cap_html"><div class="ttname"><a href="namespace_plex_byte_1_1_mo_cap.html">PlexByte.MoCap</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a2f3b313c5d86880ca913320041b47d6a"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a2f3b313c5d86880ca913320041b47d6a">PlexByte.MoCap.Backend.BackendService.GetExpenseByProjectId</a></div><div class="ttdeci">DataTable GetExpenseByProjectId(string pId)</div><div class="ttdoc">This method returns all expenses for the user or projectId specified </div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00294">BackendService.cs:294</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a1d64ef21282345f37aa3f42cba3656d2"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a1d64ef21282345f37aa3f42cba3656d2">PlexByte.MoCap.Backend.BackendService.AuthenticateUser</a></div><div class="ttdeci">DataTable AuthenticateUser(string pUserName, string pPassword)</div><div class="ttdoc">This method authenticates the given user and password against the database. If suceeded the ID of the...</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00045">BackendService.cs:45</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_aafab3576b46106ef63b5cc279e2f64bb"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#aafab3576b46106ef63b5cc279e2f64bb">PlexByte.MoCap.Backend.BackendService.GeSurveyOptionById</a></div><div class="ttdeci">DataTable GeSurveyOptionById(string pId)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00127">BackendService.cs:127</a></div></div>
<div class="ttc" id="namespace_plex_byte_html"><div class="ttname"><a href="namespace_plex_byte.html">PlexByte</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a81a6b7116d17a1d9dce39e5c8883cd0f"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a81a6b7116d17a1d9dce39e5c8883cd0f">PlexByte.MoCap.Backend.BackendService.InsertSurvey</a></div><div class="ttdeci">void InsertSurvey(string pId, string pInteractionId, int pVotesPerUser, DateTime pDueDateTime, DateTime pStartDateTime, DateTime pEndDateTime, string pCreatorId, string pOwnerId, bool pIsActive, InteractionState pState, string pProjectId, string pText, string pTitle)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00857">BackendService.cs:857</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a57d4da2ed2044f2f5bddc24ca92ee003"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a57d4da2ed2044f2f5bddc24ca92ee003">PlexByte.MoCap.Backend.BackendService.InsertSurveyOption</a></div><div class="ttdeci">void InsertSurveyOption(string pId, string pText, string pSurveyId)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l01003">BackendService.cs:1003</a></div></div>
<div class="ttc" id="namespace_plex_byte_1_1_mo_cap_1_1_backend_html_acbe18958b9ae9c08f5c2d2c580fbbf2aa8f9bfe9d1345237cb3b2b205864da075"><div class="ttname"><a href="namespace_plex_byte_1_1_mo_cap_1_1_backend.html#acbe18958b9ae9c08f5c2d2c580fbbf2aa8f9bfe9d1345237cb3b2b205864da075">PlexByte.MoCap.Backend.ObjectType.User</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a6d666dd173330adbf0b356f0144d398c"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a6d666dd173330adbf0b356f0144d398c">PlexByte.MoCap.Backend.BackendService.GetUserById</a></div><div class="ttdeci">DataTable GetUserById(string pId)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00152">BackendService.cs:152</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a21b1069392da4037e583f9d9fcad9d81"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a21b1069392da4037e583f9d9fcad9d81">PlexByte.MoCap.Backend.BackendService.GetSurveyByProjectId</a></div><div class="ttdeci">DataTable GetSurveyByProjectId(string pId, ObjectType pType)</div><div class="ttdoc">This method gets all Surveys a user can participate in or were assigned to the projectId. </div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00191">BackendService.cs:191</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_aecab0686e55208dd16015580bc4082fc"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#aecab0686e55208dd16015580bc4082fc">PlexByte.MoCap.Backend.BackendService.GetTimeSliceByProjectId</a></div><div class="ttdeci">DataTable GetTimeSliceByProjectId(string pId)</div><div class="ttdoc">This method returns all timeslices for the user or projectId specified </div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00306">BackendService.cs:306</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a922269b8f99a4c0c92d4d7df51f7024b"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a922269b8f99a4c0c92d4d7df51f7024b">PlexByte.MoCap.Backend.BackendService.GetProjectsByUser</a></div><div class="ttdeci">DataTable GetProjectsByUser(string pUserId)</div><div class="ttdoc">Returns all projects a user created, owns or is a member of </div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00262">BackendService.cs:262</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_acd4446e6836f11aa2df58262530a92a5"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#acd4446e6836f11aa2df58262530a92a5">PlexByte.MoCap.Backend.BackendService.InsertProjectMapping</a></div><div class="ttdeci">void InsertProjectMapping(string ProjectId, string ObjectId, int ObjectType)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l01195">BackendService.cs:1195</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a709aa17c80b19ca328d99eb468b9054b"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a709aa17c80b19ca328d99eb468b9054b">PlexByte.MoCap.Backend.BackendService.GetVoteCount</a></div><div class="ttdeci">DataTable GetVoteCount(string pSurveyId)</div><div class="ttdoc">This method returns a recordset containing a grouped list of votes given for the survey id specified...</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00252">BackendService.cs:252</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a0d1bc95f01b316823e1a45471f91ba85"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a0d1bc95f01b316823e1a45471f91ba85">PlexByte.MoCap.Backend.BackendService.InsertVote</a></div><div class="ttdeci">void InsertVote(string pSurveyId, string pOptionId, string pUserId, DateTime pCreated)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00797">BackendService.cs:797</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_ad65376b62e58ba7139cfdb50f05ed929"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ad65376b62e58ba7139cfdb50f05ed929">PlexByte.MoCap.Backend.BackendService.GetUserByUserName</a></div><div class="ttdeci">DataTable GetUserByUserName(string pUserName)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00157">BackendService.cs:157</a></div></div>
<div class="ttc" id="namespace_plex_byte_1_1_mo_cap_1_1_backend_html_acbe18958b9ae9c08f5c2d2c580fbbf2a"><div class="ttname"><a href="namespace_plex_byte_1_1_mo_cap_1_1_backend.html#acbe18958b9ae9c08f5c2d2c580fbbf2a">PlexByte.MoCap.Backend.ObjectType</a></div><div class="ttdeci">ObjectType</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00017">BackendService.cs:17</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a0d49092e2ea8d8d1a6cad6fb0155906f"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a0d49092e2ea8d8d1a6cad6fb0155906f">PlexByte.MoCap.Backend.BackendService.GetExpenseByProjectId</a></div><div class="ttdeci">DataTable GetExpenseByProjectId(string pId, ObjectType pType)</div><div class="ttdoc">This method gets all Expenses of a project. </div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00204">BackendService.cs:204</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a69c06da763b493aceaeab04a43c41dab"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a69c06da763b493aceaeab04a43c41dab">PlexByte.MoCap.Backend.BackendService.InsertTimeslice</a></div><div class="ttdeci">void InsertTimeslice(string pId, int pDuration, string pTargetId, string pDescription, string pTargetType, DateTime pCreatedDateTime)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l01062">BackendService.cs:1062</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a7859887daa5e4bb760dedcbcc6fb7bf1"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a7859887daa5e4bb760dedcbcc6fb7bf1">PlexByte.MoCap.Backend.BackendService.Dispose</a></div><div class="ttdeci">void Dispose()</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00038">BackendService.cs:38</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a01c6f0ba7587e8629b9ede895313ff76"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a01c6f0ba7587e8629b9ede895313ff76">PlexByte.MoCap.Backend.BackendService.GetTimesliceById</a></div><div class="ttdeci">DataTable GetTimesliceById(string pId)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00122">BackendService.cs:122</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a28c34c1d41ab5cc143ccfd5012481dfd"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a28c34c1d41ab5cc143ccfd5012481dfd">PlexByte.MoCap.Backend.BackendService.GetSurveyById</a></div><div class="ttdeci">DataTable GetSurveyById(string pId)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00112">BackendService.cs:112</a></div></div>
<div class="ttc" id="namespace_plex_byte_1_1_mo_cap_1_1_backend_html_acbe18958b9ae9c08f5c2d2c580fbbf2aa9e727fdd3aec8274f46685441900280d"><div class="ttname"><a href="namespace_plex_byte_1_1_mo_cap_1_1_backend.html#acbe18958b9ae9c08f5c2d2c580fbbf2aa9e727fdd3aec8274f46685441900280d">PlexByte.MoCap.Backend.ObjectType.Project</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a3116d762269dad9511ad9be65b8bbc7a"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a3116d762269dad9511ad9be65b8bbc7a">PlexByte.MoCap.Backend.BackendService.InsertUser</a></div><div class="ttdeci">void InsertUser(string pUserId, string pFirstName, string pLastName, string pMiddleName, string pEmail, DateTime pBirthdate, string pUserName, string pPassword)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00399">BackendService.cs:399</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_ae6b7cdf41f348ce844dfa08a876495c8"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#ae6b7cdf41f348ce844dfa08a876495c8">PlexByte.MoCap.Backend.BackendService.GetExpenseById</a></div><div class="ttdeci">DataTable GetExpenseById(string pId)</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00117">BackendService.cs:117</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a30889d7e1506e065e2f88854fae1b120"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a30889d7e1506e065e2f88854fae1b120">PlexByte.MoCap.Backend.BackendService.GetTaskByProjectId</a></div><div class="ttdeci">DataTable GetTaskByProjectId(string pId)</div><div class="ttdoc">This method gets all task for the userId or projectId specified and returns the datatable. </div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00180">BackendService.cs:180</a></div></div>
<div class="ttc" id="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service_html_a5e1cf727726998caf3fc700dc363b3bb"><div class="ttname"><a href="class_plex_byte_1_1_mo_cap_1_1_backend_1_1_backend_service.html#a5e1cf727726998caf3fc700dc363b3bb">PlexByte.MoCap.Backend.BackendService.GetUserByProjectId</a></div><div class="ttdeci">DataTable GetUserByProjectId(string pId)</div><div class="ttdoc">If project is the type, all users being member of the project with the Id specified will be returned...</div><div class="ttdef"><b>Definition:</b> <a href="_backend_service_8cs_source.html#l00169">BackendService.cs:169</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
